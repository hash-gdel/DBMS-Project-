<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MNHS Database Management</title>
<style>
/* ---------- Variables ---------- */
:root {
    --primary-color: #9CAF88;
    --secondary-color: #7FB373;
    --accent-color: #C6E0B4;
    --brown-color: #8D6E63;
    --light-color: #f5f7fa;
    --dark-color: #333;
    --success-color: #28a745;
    --warning-color: #ffc107;
    --danger-color: #dc3545;
    --border-radius: 6px;
    --box-shadow: 0 3px 8px rgba(0,0,0,0.12);
}

/* ---------- Base Styles ---------- */
* { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background-color: var(--light-color); color: var(--dark-color); line-height:1.6; min-height:100vh; }
.container { max-width:1200px; margin:0 auto; padding:0 20px; }
header { background-color: var(--primary-color); color:white; padding:1rem 0; box-shadow: var(--box-shadow); }
.header-content { display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px; }
nav ul { display:flex; list-style:none; gap:20px; }
nav a { color:white; text-decoration:none; padding:5px 10px; border-radius: var(--border-radius); transition:0.3s; }
nav a:hover, nav a.active { background-color: var(--brown-color); }

/* ---------- Dashboard ---------- */
.dashboard { display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-bottom:2rem; }
.card { background:white; border-radius: var(--border-radius); box-shadow: var(--box-shadow); padding:1.5rem; transition: transform 0.3s, box-shadow 0.3s; }
.card:hover { transform: translateY(-5px) scale(1.02); box-shadow:0 6px 15px rgba(0,0,0,0.18); }
.card h3 { color:#4F7942; margin-bottom:1rem; font-size:1.2rem; }
.stat { font-size:2rem; font-weight:bold; color: var(--primary-color); }

/* ---------- Sections ---------- */
.section { background:white; border-radius: var(--border-radius); box-shadow: var(--box-shadow); padding:1.5rem; margin-bottom:2rem; }
.section h2 { color:#4F7942; margin-bottom:1.5rem; padding-bottom:0.5rem; border-bottom:2px solid var(--accent-color); }

/* ---------- Tables ---------- */
table { width:100%; border-collapse:collapse; margin-top:1rem; display:block; overflow-x:auto; }
th, td { padding:0.75rem; text-align:left; border-bottom:1px solid #ddd; }
th { background-color: var(--accent-color); font-weight:600; color: var(--dark-color); }
tr:hover { background-color:#e0f0d9; }
.status-low { color: var(--danger-color); font-weight:bold; }

/* ---------- Tabs ---------- */
.tabs { display:flex; border-bottom:1px solid #ddd; margin-bottom:1rem; flex-wrap:wrap; }
.tab { padding:0.75rem 1.5rem; cursor:pointer; border-bottom:3px solid transparent; transition: all 0.3s; }
.tab.active { border-bottom-color: var(--primary-color); color: var(--primary-color); font-weight:600; }
.tab-content, .subtab-content { transition: opacity 0.3s ease-in-out; }
.tab-content:not(.active), .subtab-content:not(.active) { opacity:0; height:0; overflow:hidden; }
.tab-content.active, .subtab-content.active { opacity:1; height:auto; }

/* ---------- Responsive ---------- */
@media(max-width:768px){ .header-content{flex-direction:column;gap:15px} nav ul{flex-wrap:wrap; justify-content:center} .dashboard{grid-template-columns:1fr} .tabs{flex-direction:column} .tab{text-align:center} table{display:block; overflow-x:auto;} }
</style>
</head>
<body>

<header>
    <div class="container">
        <div class="header-content">
            <div class="logo"><h1>MNHS Database Management</h1></div>
            <nav>
                <ul>
                    <li><a href="#" class="active" data-tab="dashboard">Dashboard</a></li>
                    <li><a href="#" data-tab="patients">Patients</a></li>
                    <li><a href="#" data-tab="appointments">Appointments</a></li>
                    <li><a href="#" data-tab="medications">Medications</a></li>
                </ul>
            </nav>
        </div>
    </div>
</header>

<main class="container">
    <!-- Dashboard -->
    <section id="dashboard" class="tab-content active">
        <h2>MNHS Dashboard</h2>
        <div class="dashboard">
            <div class="card"><h3>Upcoming Appointments</h3><div class="stat" id="stat-appointments">0</div></div>
            <div class="card"><h3>Active Patients</h3><div class="stat" id="stat-patients">0</div></div>
            <div class="card"><h3>Low Stock Items</h3><div class="stat" id="stat-lowstock">0</div></div>
        </div>
    </section>

    <!-- Patients -->
    <section id="patients" class="tab-content">
        <h2>Patient Management</h2>
        <div class="tabs">
            <div class="tab active" data-subtab="list-patients">List Patients</div>
            <div class="tab" data-subtab="patient-next-visit">Next Visits</div>
        </div>
        <div id="list-patients" class="subtab-content active">
            <table>
                <thead><tr><th>ID</th><th>Full Name</th></tr></thead>
                <tbody id="patients-body"></tbody>
            </table>
        </div>
        <div id="patient-next-visit" class="subtab-content">
            <table>
                <thead><tr><th>Patient ID</th><th>Full Name</th><th>Next Appointment</th><th>Department</th><th>Hospital</th></tr></thead>
                <tbody id="next-visits-body"></tbody>
            </table>
        </div>
    </section>

    <!-- Appointments -->
    <section id="appointments" class="tab-content">
        <h2>Upcoming Appointments</h2>
        <table>
            <thead><tr><th>Hospital</th><th>Date</th><th>Scheduled Count</th></tr></thead>
            <tbody id="appointments-body"></tbody>
        </table>
    </section>

    <!-- Medications -->
    <section id="medications" class="tab-content">
        <h2>Low Stock Medications</h2>
        <table>
            <thead><tr><th>Hospital</th><th>Medication</th><th>Current Stock</th></tr></thead>
            <tbody id="lowstock-body"></tbody>
        </table>
    </section>
</main>

<script>
// ---------- Main Tabs ----------
const tabLinks = document.querySelectorAll('nav a[data-tab]');
const tabContents = document.querySelectorAll('.tab-content');

tabLinks.forEach(link => {
    link.addEventListener('click', e => {
        e.preventDefault();
        tabLinks.forEach(l=>l.classList.remove('active'));
        link.classList.add('active');
        const target = link.dataset.tab;
        tabContents.forEach(tc=>tc.classList.remove('active'));
        document.getElementById(target).classList.add('active');

        // Reset subtabs
        const subtabs = document.querySelectorAll('#'+target+' .tab');
        const subContents = document.querySelectorAll('#'+target+' .subtab-content');
        if(subtabs.length){
            subtabs.forEach((st,i)=>{st.classList.remove('active'); if(i===0) st.classList.add('active');});
            subContents.forEach((sc,i)=>{sc.classList.remove('active'); if(i===0) sc.classList.add('active');});
        }
    });
});

// ---------- Sub Tabs ----------
document.querySelectorAll('.tabs').forEach(tabContainer=>{
    const tabs = tabContainer.querySelectorAll('.tab');
    tabs.forEach(tab=>{
        tab.addEventListener('click', ()=>{
            tabs.forEach(t=>t.classList.remove('active'));
            tab.classList.add('active');
            const subContents = tabContainer.parentElement.querySelectorAll('.subtab-content');
            subContents.forEach(sc=>sc.classList.remove('active'));
            document.getElementById(tab.dataset.subtab).classList.add('active');
        });
    });
});

// ---------- Fetch data from backend ----------
function fetchData(){
    // Patients
    fetch('/api/patients').then(r=>r.json()).then(data=>{
        const tbody = document.getElementById('patients-body');
        tbody.innerHTML = '';
        data.forEach(p=>{
            tbody.innerHTML += `<tr><td>${p.IID}</td><td>${p.FullName}</td></tr>`;
        });
        document.getElementById('stat-patients').textContent = data.length;
    });

    // Low Stock
    fetch('/api/low_stock').then(r=>r.json()).then(data=>{
        const tbody = document.getElementById('lowstock-body');
        tbody.innerHTML = '';
        data.forEach(item=>{
            tbody.innerHTML += `<tr><td>${item.HospitalName}</td><td>${item.MedicationName}</td><td class="status-low">${item.Qty}</td></tr>`;
        });
        document.getElementById('stat-lowstock').textContent = data.length;
    });

    // Upcoming Appointments
    fetch('/api/patients').then(r=>r.json()).then(data=>{
        // Dummy upcoming visits for demonstration
        const tbody = document.getElementById('appointments-body');
        tbody.innerHTML = '';
        data.slice(0,5).forEach((p,i)=>{
            tbody.innerHTML += `<tr><td>Hospital ${i+1}</td><td>2025-03-${15+i}</td><td>${Math.floor(Math.random()*10)}</td></tr>`;
        });
        document.getElementById('stat-appointments').textContent = data.length;
    });
}

fetchData();
</script>

</body>
</html>
